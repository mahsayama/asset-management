{% load humanize %}

<div class="table-responsive">
    <table class="table table-hover align-middle text-start mb-0">
        <thead class="bg-light">
            <tr>
                <th class="ps-4">Nama Aset</th>
                <th>Barcode / SN</th>            
                <th class="d-none d-md-table-cell">Kategori</th>
                <th class="d-none d-md-table-cell">Lokasi</th>
                <th>User / Dept Saat Ini</th>
                <th class="d-none d-xl-table-cell">History</th> 
                <th>Status</th>
                <th class="d-none d-lg-table-cell">Harga</th>
                <th class="text-center" style="min-width: 120px;">Aksi</th> 
            </tr>
        </thead>
        <tbody>
            {% for asset in assets %}
            <tr>
                <td class="ps-4">
                    <div class="fw-bold text-dark">{{ asset.name }}</div>
                    <small class="text-muted d-block d-md-none font-monospace mt-1">{{ asset.serial_number }}</small>
                </td>
                <td>
                    {% if asset.barcode_id %}
                        <div class="badge bg-light text-dark border mb-1 font-monospace" style="font-size: 0.75rem;">{{ asset.barcode_id }}</div>
                    {% endif %}
                    <div class="small text-muted font-monospace d-none d-md-block">{{ asset.serial_number }}</div>
                </td>
                <td class="d-none d-md-table-cell text-muted small">{{ asset.kategori|default:"-" }}</td>
                <td class="d-none d-md-table-cell text-muted small">{{ asset.lokasi|default:"-" }}</td>
                <td>
                    <div class="fw-medium text-dark">{{ asset.current_user|default:"-" }}</div>
                    <small class="text-muted d-block" style="font-size: 0.75rem;">{{ asset.current_dept|default:"" }}</small>
                </td>
                <td class="d-none d-xl-table-cell small text-muted">
                    <div style="font-size: 0.75rem;"><i class="bi bi-clock-history"></i> {{ asset.prev_user|default:"-" }}</div>
                    <div style="font-size: 0.75rem;"><i class="bi bi-building"></i> {{ asset.prev_dept|default:"-" }}</div>
                </td>
                <td>
                    {% if asset.status == 'TERSEDIA' %}
                        <span class="badge bg-success bg-opacity-10 text-success border border-success-subtle rounded-pill px-3 py-1 fw-medium">Tersedia</span>
                    {% elif asset.status == 'DIPAKAI' %}
                        <span class="badge bg-primary bg-opacity-10 text-primary border border-primary-subtle rounded-pill px-3 py-1 fw-medium">Dipakai</span>
                    {% elif asset.status == 'RUSAK' %}
                        <span class="badge bg-danger bg-opacity-10 text-danger border border-danger-subtle rounded-pill px-3 py-1 fw-medium">Rusak</span>
                    {% else %}
                        <span class="badge bg-warning bg-opacity-10 text-dark border border-warning-subtle rounded-pill px-3 py-1 fw-medium">Hilang</span>
                    {% endif %}
                </td>
                <td class="d-none d-lg-table-cell font-monospace fw-medium text-dark">
                    Rp {{ asset.price|intcomma|default:"0" }}
                </td>
                
                <td class="text-center">
                    <a href="{% url 'asset_detail' asset.pk %}" class="text-primary text-decoration-none mx-1" title="Detail" data-bs-toggle="tooltip">
                        <i class="bi bi-eye fs-5"></i>
                    </a>
                    <a href="{% url 'asset_update' asset.pk %}" class="text-warning text-decoration-none mx-1" title="Edit" data-bs-toggle="tooltip">
                        <i class="bi bi-pencil-square fs-5"></i>
                    </a>
                    <a href="{% url 'asset_delete' asset.pk %}" class="text-danger text-decoration-none mx-1" title="Hapus" data-bs-toggle="tooltip">
                        <i class="bi bi-trash fs-5"></i>
                    </a>
                </td>
                </tr>
            {% empty %}
            <tr>
                <td colspan="9" class="text-center py-5">
                    <div class="mb-3 text-muted opacity-25">
                        <i class="bi bi-inbox" style="font-size: 3rem;"></i>
                    </div>
                    <h6 class="fw-bold text-dark">Data Tidak Ditemukan</h6>
                    <p class="small text-muted mb-0">
                        {% if query %}
                            Tidak ada aset dengan kata kunci "<strong>{{ query }}</strong>".
                        {% else %}
                            Belum ada data aset di database.
                        {% endif %}
                    </p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if assets.has_other_pages %}
<div class="d-flex justify-content-between align-items-center p-3 border-top bg-white">
    <small class="text-muted">
        Halaman {{ assets.number }} dari {{ assets.paginator.num_pages }}
    </small>
    <div class="btn-group">
        {% if assets.has_previous %}
        <button class="btn btn-sm btn-outline-secondary" 
                hx-get="?page={{ assets.previous_page_number }}&q={{ query|default:'' }}&category={{ category_filter }}&location={{ location_filter }}&status={{ status_filter }}"
                hx-target="#table-container" 
                hx-swap="innerHTML">
            <i class="bi bi-chevron-left"></i> Prev
        </button>
        {% endif %}
        
        {% if assets.has_next %}
        <button class="btn btn-sm btn-outline-secondary" 
                hx-get="?page={{ assets.next_page_number }}&q={{ query|default:'' }}&category={{ category_filter }}&location={{ location_filter }}&status={{ status_filter }}"
                hx-target="#table-container" 
                hx-swap="innerHTML">
            Next <i class="bi bi-chevron-right"></i>
        </button>
        {% endif %}
    </div>
</div>
{% endif %}